if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
#aromatic_rings_final<- rbind(aromatic_rings_final, aromatic_rings)
}
}
}
ring.elements
ring.elements[1]
ring.elements[[1]]
table(ring.elements)
table(ring.elements[[1]])
table(ring.elements[1])
table(ring.elements[1])
table(ring.elements)["C"]
table(ring.elements[1])["C"]
table(ring.elements[1])["0"]
ring.elements
names(ring.elements)
"C" %in% ring.elements
"C" %in% ring.elements[1]
"C" %in% ring.elements[2]
"C" %in% ring.elements[[1]]
"C" %in% ring.elements[[2]]
"C" %in% ring.elements[[3]]
"O" %in% ring.elements[[3]]
length(ring.elements)
ring.elements
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
if("C" %in% ring.elements[[3]] == TRUE)
ring.aliphatic.carbon<- ring.elements[,"C"]
#ring.aliphatic.carbon <-
#aromatic_rings_final<- rbind(aromatic_rings_final, aromatic_rings)
}
}
}
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
if("C" %in% ring.elements[[3]] == TRUE)
ring.aliphatic.carbon<- ring.elements[[3]][,"C"]
#ring.aliphatic.carbon <-
#aromatic_rings_final<- rbind(aromatic_rings_final, aromatic_rings)
}
}
}
aromatic_rings_final<- list()
ring.carbon.counter <- 0
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[[j]] == TRUE)
ring.aliphatic.carbon <- ring.carbon.counter + 1
}
}
}
}
ring.aliphatic.carbon
ring.elements[[1]]
ring.elements[[2
]]
ring.elements[[3
]]
ring.elements[[4
]]
ring.elements[[5
]]
ring.elements[[6
]]
ring.elements[[7
]]
ring.carbon.counter
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
ring.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[[j]] == TRUE)
ring.aliphatic.carbon <- ring.carbon.counter + 1
}
}
}
}
ring.carbon.counter
length(ring.elements)
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
ring.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[[j]] == TRUE)
ring.aliphatic.carbon <- j
}
}
}
}
ring.aliphatic.carbon
ring.elements[[1]]
ring.elements[[2]]
ring.elements[,1]
ring.elements[,2]
ring.elements[,3]
ring.elements[,7]
ring.elements[1,1]
ring.elements[1,]
ring.elements[,1]
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
ring.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
ring.aliphatic.carbon <-  ring.elements[,"C"]
}
}
}
}
ring.elements[,1]
ring.elements[,"C"]
ring.elements[,1]
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.carbon.counter<-0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
}
}
}
}
aliphatic.carbon.counter
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.carbon.counter<-0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
}
}
}
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
if("Br" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
}
}
}
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
}
}
}
aliphatic.oxygen.counter
length(ring.elements)
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
} if(aliphatic.carbon.counter  == 5 && aliphatic.oxygen.counter == 1 && length(ring.elements)==6)
{
sugar.present <- 1
}
}
}
}
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
}
}
}
aliphatic.carbon.counter
aliphatic.oxygen.counter
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
sugar.present <- 0
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
if(aliphatic.carbon.counter  == 5 && aliphatic.oxygen.counter == 1 && length(ring.elements)==6)
{
sugar.present <- 1
}
}
}
}
sugar.present
aromatic_rings_final<- list()
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
if(aliphatic.carbon.counter  == 5 && aliphatic.oxygen.counter == 1 && length(ring.elements)==6)
{
sugar.present <- 1
}
}
}
}
sugar.present
aromatic_rings_final<- list()
sugar.present<- 0
if(!is.null(rings$AROMATIC))
{
for(i in 1:length(rings$AROMATIC))
{
if(rings$AROMATIC[i]==FALSE)
{
aromatic_rings<- rings$RINGS[i]
ring.elements<-  data.frame(strsplit(aromatic_rings[[1]],"_"))[1,]
aliphatic.oxygen.counter <- 0
aliphatic.carbon.counter <- 0
for(j in 1:length(ring.elements))
{
if("C" %in% ring.elements[,j] == TRUE)
{
aliphatic.carbon.counter <- aliphatic.carbon.counter + 1
}
else if("O" %in% ring.elements[,j] == TRUE)
{
aliphatic.oxygen.counter <- aliphatic.oxygen.counter + 1
}
}
if(aliphatic.carbon.counter  == 5 && aliphatic.oxygen.counter == 1 && length(ring.elements)==6)
{
sugar.present <- 1
}
}
}
}
sugar.present
setwd("C:/Users/Saurav Saha/Dropbox/office/Saurav_Saha_SHIATS/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/R-Package/uCAREChemSuiteCLI")
rm(list = ls())
library(uCAREChemSuiteCLI)
setwd("C:/Users/Saurav Saha/Dropbox/office/Saurav_Saha_SHIATS/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/R-Package/uCAREChemSuiteCLI")
library(uCAREChemSuiteCLI)
setwd("C:/Users/Saurav Saha/Dropbox/office/Saurav_Saha_SHIATS/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/R-Package/uCAREChemSuiteCLI/R")
library(uCAREChemSuiteCLI)
setwd("C:/Users/Saurav Saha/Dropbox/office/Saurav_Saha_SHIATS/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/Validation/take2/sdf_screened")
library("uCAREChemSuiteCLI", lib.loc="~/R/win-library/3.4")
file_screened<-read.csv("drug_list_screened.csv", header = TRUE)
cid_screened<-file_screened["CID"]
actual_class<- file_screened["Class.of.Drug..PubChem.Classification."]
predicted_class_final<-0
chart_predicted_class<-0
for(i in 1:nrow(cid_screened))
{
# Preprocessing
sdf<- paste0('Structure2D_CID_',cid_screened[[1]][i],'.sdf')
# Running script
predicted_class<- drug.class.deterministic(sdf[1])
# Postprocessing
chart_predicted_class<- cbind(i,cid_screened[[1]][i],as.character(actual_class[[1]][i]), predicted_class[1])
predicted_class_final<- rbind(predicted_class_final,chart_predicted_class)
}
colnames(predicted_class_final)<- c("SI No", "CID", "Actual class", "Predicted class")
# File writing
write.table(predicted_class_final[-1,-1], file = "./deterministic/deterministic.csv",sep = ",",col.names = TRUE, row.names = FALSE)
file_screened<-read.csv("drug_list_screened.csv", header = TRUE)
cid_screened<-file_screened["CID"]
actual_class<- file_screened["Class.of.Drug..PubChem.Classification."]
predicted_class_final<-0
chart_predicted_class<-0
for(i in 1:nrow(cid_screened))
{
# Preprocessing
sdf<- paste0('Structure2D_CID_',cid_screened[[1]][i],'.sdf')
# Running script
predicted_class<- drug.class.deterministic(sdf[1])
# Postprocessing
chart_predicted_class<- cbind(i,cid_screened[[1]][i],as.character(actual_class[[1]][i]), predicted_class[1])
predicted_class_final<- rbind(predicted_class_final,chart_predicted_class)
}
colnames(predicted_class_final)<- c("SI No", "CID", "Actual class", "Predicted class")
# File writing
write.table(predicted_class_final[-1,-1], file = "./deterministic/deterministic.csv",sep = ",",col.names = TRUE, row.names = FALSE)
q()
setwd("C:/Users/Saurav Saha/Dropbox/office/saurav_saha_shiats/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/R-Package/uCAREChemSuiteCLI/R")
library(uCAREChemSuiteCLI)
setwd("C:/Users/Saurav Saha/Dropbox/office/saurav_saha_shiats/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/classes/Aminoglycoside")
read.SDFset(sdfstr = "Aminoglycoside.sdf")
library(ChemmineR)
read.SDFset(sdfstr = "Aminoglycoside.sdf")
sdf<-read.SDFset(sdfstr = "Aminoglycoside.sdf")
functional.group<- groups(sdf, groups="fctgroup", type="countMA")
functional.group
library(uCAREChemSuiteCLI)
functional.group[,"ROR"]
functional.group[,"ROH"]
library(uCAREChemSuiteCLI)
is.null(functional.group[,"ROH"])
!is.null(functional.group[,"ROH"])
functional.group<- groups(sdf[1], groups="fctgroup", type="countMA")
functional.group
functional.group[,5]
functional.group[[,5]]
functional.group[1]
functional.group[2]
functional.group[3]
functional.group[4]
functional.group[5]
functional.group[5]
functional.group[10]
functional.group[11]
is.null(functional.group[11])
library(uCAREChemSuiteCLI)
functional.group[5]
functional.group[5]!=0
functional.group[5]==0
functional.group["ROR"]==0
functional.group["ROR"]
functional.group["ROH"]
library(uCAREChemSuiteCLI)
library("uCAREChemSuiteCLI", lib.loc="~/R/win-library/3.4")
setwd("C:/Users/Saurav Saha/Dropbox/office/saurav_saha_shiats/PhD/Chemoinformatics_uCARE_Ecoli/analysis/drug_class_based_Classification/r_scripts/Validation/take2/sdf_screened")
file_screened<-read.csv("drug_list_screened.csv", header = TRUE)
cid_screened<-file_screened["CID"]
actual_class<- file_screened["Class.of.Drug..PubChem.Classification."]
predicted_class_final<-0
chart_predicted_class<-0
for(i in 1:nrow(cid_screened))
{
# Preprocessing
sdf<- paste0('Structure2D_CID_',cid_screened[[1]][i],'.sdf')
# Running script
predicted_class<- drug.class.deterministic(sdf[1])
# Postprocessing
chart_predicted_class<- cbind(i,cid_screened[[1]][i],as.character(actual_class[[1]][i]), predicted_class[1])
predicted_class_final<- rbind(predicted_class_final,chart_predicted_class)
}
colnames(predicted_class_final)<- c("SI No", "CID", "Actual class", "Predicted class")
# File writing
write.table(predicted_class_final[-1,-1], file = "./deterministic/deterministic.csv",sep = ",",col.names = TRUE, row.names = FALSE)
q()
library(uCAREChemSuiteCLI)
q()
